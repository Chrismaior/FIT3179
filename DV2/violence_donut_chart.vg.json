{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "background": "transparent",
  "width": 300,
  "height": 300,

  "data": {
    "values": [
      {"Region": "Europe",   "Value": 1840606},
      {"Region": "Africa",   "Value": 152577},
      {"Region": "Americas", "Value": 1852875},
      {"Region": "Asia",     "Value": 310553},
      {"Region": "Oceania",  "Value": 189290}
    ]
  },

  "transform": [
    {"joinaggregate": [{"op": "sum", "field": "Value", "as": "Total"}]},
    {"calculate": "datum.Value / datum.Total", "as": "Percent"},
    {"calculate": "format(datum.Percent, '.1%')", "as": "PercentLabel"}
  ],

  "layer": [
    {
      "mark": {"type": "arc", "innerRadius": 110, "stroke": null},
      "encoding": {
        "theta": {"field": "Value", "type": "quantitative", "stack": true},
        "color": {
          "field": "Region",
          "type": "nominal",
          "scale": {"range": ["#9e0000", "#5e97ba", "#3052d9", "#f22121", "#0f87c2"]},
          "legend": null
        },
        "tooltip": [
          {"field": "Region", "type": "nominal"},
          {"field": "Value", "type": "quantitative", "title": "Offences", "format": ",d"},
          {"field": "Percent", "type": "quantitative", "title": "Share", "format": ".1%"}
        ]
      }
    },


    {
      "mark": {
        "type": "text",
        "fill": "white",
        "fontSize": 16,
        "radius": {"expr": "min(width, height)/2"},
        "radiusOffset": 25,                          
        "stroke": "white",
        "strokeWidth": 0.25
      },
      "encoding": {
        "theta": {"field": "Value", "type": "quantitative", "stack": true},
        "text": {"field": "PercentLabel"}
      }
    },


    {
      "mark": {
        "type": "text",
        "align": "center",
        "baseline": "middle",
        "fontSize": 16,
        "fill": "white",
        "lineBreak": "\n"                            
      },
      "encoding": {
        "text": {"value": "Violent & Sexual Crime\nOffences by Region, 2023"}
      }
    }
  ],

  "config": {
    "view": {"stroke": null}
  }
}
